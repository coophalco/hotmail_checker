# https://github.com/coophalco
import json, base64, os, sys, zlib, lzma, gzip, marshal
from Crypto.Protocol.KDF import PBKDF2
from Crypto.Hash import SHA256
from Crypto.Cipher import AES
import getpass

payload = json.loads('{"mode": "password", "salt": "GollF5yXGiTQQwYgSbTCRw==", "kdf_iters": 200000, "nonce": "Tgk4ca4DzJPDcMMk", "tag": "jzagYuSJcB1kHD1x/C42uQ==", "ciphertext": "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", "wrapped_key": "2lXfBGJvRRnHnM/gFiSsZlmaRIOZBlyVRNGyOqlHANw=", "wrap_nonce": "+bTLKCWBEDvM95cs", "wrap_tag": "FRF4ez3SFsy/MHN0eA3pxg=="}')
if payload.get("mode") != "password":
    print("Bad payload")
    sys.exit(1)

salt = base64.b64decode(payload["salt"])
iters = int(payload["kdf_iters"])
nonce = base64.b64decode(payload["nonce"])
tag = base64.b64decode(payload["tag"])
ciphertext = base64.b64decode(payload["ciphertext"])

wrapped_key = base64.b64decode(payload["wrapped_key"])
wrap_nonce = base64.b64decode(payload["wrap_nonce"])
wrap_tag = base64.b64decode(payload["wrap_tag"])

pw = os.environ.get("ENCPW")
if pw is None:
    pw = getpass.getpass("press_enter") 
if isinstance(pw, str):
    pw = pw.encode()

kek = PBKDF2(pw, salt, dkLen=32, count=iters, hmac_hash_module=SHA256)

wrap_cipher = AES.new(kek, AES.MODE_GCM, nonce=wrap_nonce)
key = wrap_cipher.decrypt_and_verify(wrapped_key, wrap_tag)

cipher = AES.new(key, AES.MODE_GCM, nonce=nonce)
decompressed = cipher.decrypt_and_verify(ciphertext, tag)

lzmaed = zlib.decompress(decompressed)
gzipped = lzma.decompress(lzmaed)
marshaled = gzip.decompress(gzipped)
codeobj = marshal.loads(marshaled)

exec(codeobj, globals())
