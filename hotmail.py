# https://github.com/coophalco
import json, base64, os, sys, zlib, lzma, gzip, marshal
from Crypto.Protocol.KDF import PBKDF2
from Crypto.Hash import SHA256
from Crypto.Cipher import AES
import getpass

payload = json.loads('{"mode": "password", "salt": "D9NGcgxynRJoQwQs4W75Jg==", "kdf_iters": 200000, "nonce": "bFZjx3LFNKWN/I3V", "tag": "qRHsYKsO08oHIzjIze2Cwg==", "ciphertext": "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", "wrapped_key": "sqs8Z4STMZdz//MHQCjOxUpZd3g3X9X6t/V/jCPM+rY=", "wrap_nonce": "Xi4qb0gIoGNcZY7q", "wrap_tag": "0RXzS8LovwOMnCqjeHw8og=="}')
if payload.get("mode") != "password":
    print("Bad payload")
    sys.exit(1)

salt = base64.b64decode(payload["salt"])
iters = int(payload["kdf_iters"])
nonce = base64.b64decode(payload["nonce"])
tag = base64.b64decode(payload["tag"])
ciphertext = base64.b64decode(payload["ciphertext"])

wrapped_key = base64.b64decode(payload["wrapped_key"])
wrap_nonce = base64.b64decode(payload["wrap_nonce"])
wrap_tag = base64.b64decode(payload["wrap_tag"])

pw = os.environ.get("ENCPW")
if pw is None:
    pw = getpass.getpass("press_enter") 
if isinstance(pw, str):
    pw = pw.encode()

kek = PBKDF2(pw, salt, dkLen=32, count=iters, hmac_hash_module=SHA256)

wrap_cipher = AES.new(kek, AES.MODE_GCM, nonce=wrap_nonce)
key = wrap_cipher.decrypt_and_verify(wrapped_key, wrap_tag)

cipher = AES.new(key, AES.MODE_GCM, nonce=nonce)
decompressed = cipher.decrypt_and_verify(ciphertext, tag)

lzmaed = zlib.decompress(decompressed)
gzipped = lzma.decompress(lzmaed)
marshaled = gzip.decompress(gzipped)
codeobj = marshal.loads(marshaled)

exec(codeobj, globals())
