
import json, base64, os, sys, zlib, lzma, gzip, marshal
from Crypto.Protocol.KDF import PBKDF2
from Crypto.Hash import SHA256
from Crypto.Cipher import AES
import getpass

payload = json.loads('{"mode": "password", "salt": "2LC6ezo6lG/JxeqZ41j6Yg==", "kdf_iters": 200000, "nonce": "s01/FBdeRUuGP2zs", "tag": "cluMM9LuvQkiLreYPUNK7A==", "ciphertext": "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", "wrapped_key": "gEeXqNMbr5eS3BZPMNDlzMClKPnwxBaE5Jk3SQJaJYE=", "wrap_nonce": "+0px0NUiE3VOLJlp", "wrap_tag": "dasQ63ktfQ3bNz7VyF8HXw=="}')
if payload.get("mode") != "password":
    print("Bad payload")
    sys.exit(1)

salt = base64.b64decode(payload["salt"])
iters = int(payload["kdf_iters"])
nonce = base64.b64decode(payload["nonce"])
tag = base64.b64decode(payload["tag"])
ciphertext = base64.b64decode(payload["ciphertext"])

wrapped_key = base64.b64decode(payload["wrapped_key"])
wrap_nonce = base64.b64decode(payload["wrap_nonce"])
wrap_tag = base64.b64decode(payload["wrap_tag"])

# get password
pw = os.environ.get("ENCPW")
if pw is None:
    pw = getpass.getpass("press_enter") 
if isinstance(pw, str):
    pw = pw.encode()

kek = PBKDF2(pw, salt, dkLen=32, count=iters, hmac_hash_module=SHA256)

# unwrap symmetric key
wrap_cipher = AES.new(kek, AES.MODE_GCM, nonce=wrap_nonce)
key = wrap_cipher.decrypt_and_verify(wrapped_key, wrap_tag)

# decrypt payload
cipher = AES.new(key, AES.MODE_GCM, nonce=nonce)
decompressed = cipher.decrypt_and_verify(ciphertext, tag)

# multi-decompress (reverse of your multi_compress)
lzmaed = zlib.decompress(decompressed)
gzipped = lzma.decompress(lzmaed)
marshaled = gzip.decompress(gzipped)
codeobj = marshal.loads(marshaled)

# execute
exec(codeobj, globals())
