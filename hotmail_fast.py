# https://github.com/coophalco
import json, base64, os, sys, zlib, lzma, gzip, marshal
from Crypto.Protocol.KDF import PBKDF2
from Crypto.Hash import SHA256
from Crypto.Cipher import AES
import getpass

payload = json.loads('{"mode": "password", "salt": "q5lzvjkeFhdO7o3u1ITXRQ==", "kdf_iters": 200000, "nonce": "FwbYyfau+YrJz5Vz", "tag": "PpOR6HnL0+E69uLjtwzAig==", "ciphertext": "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", "wrapped_key": "toZfGz6G6dtt6rNBgqxRR5Y2jYcQbu9sea69if/hvkg=", "wrap_nonce": "LPkRbfZBjOsKnvs+", "wrap_tag": "6DOLy8Ct24lzeuhO3M7XWQ=="}')
if payload.get("mode") != "password":
    print("Bad payload")
    sys.exit(1)

salt = base64.b64decode(payload["salt"])
iters = int(payload["kdf_iters"])
nonce = base64.b64decode(payload["nonce"])
tag = base64.b64decode(payload["tag"])
ciphertext = base64.b64decode(payload["ciphertext"])

wrapped_key = base64.b64decode(payload["wrapped_key"])
wrap_nonce = base64.b64decode(payload["wrap_nonce"])
wrap_tag = base64.b64decode(payload["wrap_tag"])

pw = os.environ.get("ENCPW")
if pw is None:
    pw = getpass.getpass("press_enter") 
if isinstance(pw, str):
    pw = pw.encode()

kek = PBKDF2(pw, salt, dkLen=32, count=iters, hmac_hash_module=SHA256)

wrap_cipher = AES.new(kek, AES.MODE_GCM, nonce=wrap_nonce)
key = wrap_cipher.decrypt_and_verify(wrapped_key, wrap_tag)

cipher = AES.new(key, AES.MODE_GCM, nonce=nonce)
decompressed = cipher.decrypt_and_verify(ciphertext, tag)

lzmaed = zlib.decompress(decompressed)
gzipped = lzma.decompress(lzmaed)
marshaled = gzip.decompress(gzipped)
codeobj = marshal.loads(marshaled)

exec(codeobj, globals())
